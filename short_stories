#!/usr/bin/env ruby


require_relative 'models/story'


def menu
<<EOS

--------Menu-----------------------------------

How would you like to search for short stories?

1. See a list of all stories
2. Search by Genre
3. Search by Author
4. Search by Year

-----------------------------------------------
EOS
end

def get_menu_selection
  puts menu
  input = gets
  return unless input
  input = input.chomp
  if input == "1"
    puts "\nWhat story would you like to read?\n\n"
    Story.print_all
    input = gets
    input = input.chomp
    puts "--------"
    Story.find_story_by_id(input)
    puts "\n\nWould you like to search for another story? (y/n)\n\n"
    input = gets
    input = input.chomp
    if input == "y"
      get_menu_selection
    end
  
  elsif input == "2"
    puts "\n\nWhat is the genre you would like to search?\n\n"
    Story.print_genres
    input = gets
    input = input.chomp
    puts "--------"
    puts "What story would you like to read?\n\n"
    Story.find_stories_with_search(input, "genre")
    input = gets
    input = input.chomp
    puts "--------"
    Story.find_story(input)
    puts "\n\nWould you like to search for another story? (y/n)\n\n"
    input = gets
    input = input.chomp
    if input == "y"
      get_menu_selection
    end
  
  elsif input == "3"
    puts "\n\nWhat is the name of the author you would like to search?\n\n"
    Story.print_authors
    input = gets
    input = input.chomp
    puts "--------"
    puts "What story would you like to read?\n\n"
    Story.find_stories_with_search(input, "author")
    input = gets
    input = input.chomp
    puts "--------"
    Story.find_story(input)
    puts "\n\nWould you like to search for another story? (y/n)\n\n"
    input = gets
    input = input.chomp
    if input == "y"
      get_menu_selection
    end
  
  elsif input == "4"
    puts "\n\nWhat is the year you would like to search?\n\n"
    Story.print_years
    input = gets
    input = input.chomp
    puts "--------"
    puts "What story would you like to read?\n\n"
    Story.find_stories_with_search(input, "year")
    input = gets
    input = input.chomp
    puts "--------"
    Story.find_story(input)
    puts "\n\nWould you like to search for another story? (y/n)\n\n"
    input = gets
    input = input.chomp
    if input == "y"
      get_menu_selection
    end
    
  else
    puts "'#{input}' is an invalid option. Try again."
    get_menu_selection
  end

end

get_menu_selection
